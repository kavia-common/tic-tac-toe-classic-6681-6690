// This script ensures gradle wrapper is properly set up
def wrapperPath = "$rootDir/gradlew"
def wrapperBatPath = "$rootDir/gradlew.bat"
def wrapperJarPath = "$rootDir/gradle/wrapper/gradle-wrapper.jar"
def wrapperPropsPath = "$rootDir/gradle/wrapper/gradle-wrapper.properties"

// Ensure wrapper script is executable
if (!file(wrapperPath).canExecute()) {
    file(wrapperPath).setExecutable(true)
}

if (!file(wrapperJarPath).exists()) {
    def wrapperDir = file("$rootDir/gradle/wrapper")
    wrapperDir.mkdirs()
    
    // Create wrapper jar marker for download
    new File(wrapperPropsPath).text = """
        distributionBase=GRADLE_USER_HOME
        distributionPath=wrapper/dists
        distributionUrl=https\\://services.gradle.org/distributions/gradle-7.5.1-bin.zip
        zipStoreBase=GRADLE_USER_HOME
        zipStorePath=wrapper/dists
    """.trim()
}
